// Translation data for all 9 languages
const translations = {
    en: {
        'app-title': 'IT Driving Test',
        'app-description': 'The complete app to prepare for your Italian driving license exam',
        'features': 'Features',
        'feature-1-title': '9,353 Official Questions',
        'feature-1-desc': 'Complete database of official Italian driving test questions with translations in 9 languages',
        'feature-2-title': 'Multilingual Support',
        'feature-2-desc': 'Available in Italian, English, Chinese, Spanish, French, German, Arabic, Russian, and Albanian',
        'feature-3-title': 'Practice & Test Modes',
        'feature-3-desc': 'Practice by category or difficulty, then test yourself with realistic exam simulations',
        'feature-4-title': 'Progress Tracking',
        'feature-4-desc': 'Track your performance, review wrong answers, and focus on challenging topics',
        'privacy-policy': 'Privacy Policy',
        'terms-of-service': 'Terms of Service',
        'all-rights': 'All rights reserved.',
        'contact-support': 'Contact Support',
        'privacy': 'Privacy',
        'terms': 'Terms',
        'last-updated': 'Last Updated',
        'introduction': 'Introduction',
        'accept': 'I Accept',
        'decline': 'Decline'
    },
    it: {
        'app-title': 'IT Driving Test',
        'app-description': 'L\'app completa per prepararsi all\'esame della patente italiana',
        'features': 'Caratteristiche',
        'feature-1-title': '9.353 Domande Ufficiali',
        'feature-1-desc': 'Database completo delle domande ufficiali dell\'esame di guida italiano con traduzioni in 9 lingue',
        'feature-2-title': 'Supporto Multilingue',
        'feature-2-desc': 'Disponibile in italiano, inglese, cinese, spagnolo, francese, tedesco, arabo, russo e albanese',
        'feature-3-title': 'Modalità Pratica e Test',
        'feature-3-desc': 'Esercitati per categoria o difficoltà, poi mettiti alla prova con simulazioni d\'esame realistiche',
        'feature-4-title': 'Monitoraggio Progressi',
        'feature-4-desc': 'Traccia le tue prestazioni, rivedi le risposte sbagliate e concentrati sugli argomenti difficili',
        'privacy-policy': 'Informativa sulla Privacy',
        'terms-of-service': 'Termini di Servizio',
        'all-rights': 'Tutti i diritti riservati.',
        'contact-support': 'Contatta il Supporto',
        'privacy': 'Privacy',
        'terms': 'Termini',
        'last-updated': 'Ultimo Aggiornamento',
        'introduction': 'Introduzione',
        'accept': 'Accetto',
        'decline': 'Rifiuta'
    },
    zh: {
        'app-title': '意大利驾考',
        'app-description': '准备意大利驾照考试的完整应用程序',
        'features': '功能特点',
        'feature-1-title': '9,353道官方题目',
        'feature-1-desc': '完整的意大利驾考官方题库，支持9种语言翻译',
        'feature-2-title': '多语言支持',
        'feature-2-desc': '支持意大利语、英语、中文、西班牙语、法语、德语、阿拉伯语、俄语和阿尔巴尼亚语',
        'feature-3-title': '练习和考试模式',
        'feature-3-desc': '按类别或难度练习，然后通过真实的考试模拟测试自己',
        'feature-4-title': '进度跟踪',
        'feature-4-desc': '跟踪您的表现，复习错题，专注于有挑战性的主题',
        'privacy-policy': '隐私政策',
        'terms-of-service': '服务条款',
        'all-rights': '版权所有。',
        'contact-support': '联系支持',
        'privacy': '隐私',
        'terms': '条款',
        'last-updated': '最后更新',
        'introduction': '简介',
        'accept': '接受',
        'decline': '拒绝'
    },
    es: {
        'app-title': 'IT Driving Test',
        'app-description': 'La aplicación completa para preparar tu examen de conducir italiano',
        'features': 'Características',
        'feature-1-title': '9.353 Preguntas Oficiales',
        'feature-1-desc': 'Base de datos completa de preguntas oficiales del examen de conducir italiano con traducciones en 9 idiomas',
        'feature-2-title': 'Soporte Multiidioma',
        'feature-2-desc': 'Disponible en italiano, inglés, chino, español, francés, alemán, árabe, ruso y albanés',
        'feature-3-title': 'Modos de Práctica y Examen',
        'feature-3-desc': 'Practica por categoría o dificultad, luego ponte a prueba con simulaciones de examen realistas',
        'feature-4-title': 'Seguimiento del Progreso',
        'feature-4-desc': 'Rastrea tu rendimiento, revisa las respuestas incorrectas y concéntrate en los temas desafiantes',
        'privacy-policy': 'Política de Privacidad',
        'terms-of-service': 'Términos de Servicio',
        'all-rights': 'Todos los derechos reservados.',
        'contact-support': 'Contactar Soporte',
        'privacy': 'Privacidad',
        'terms': 'Términos',
        'last-updated': 'Última Actualización',
        'introduction': 'Introducción',
        'accept': 'Aceptar',
        'decline': 'Rechazar'
    },
    fr: {
        'app-title': 'IT Driving Test',
        'app-description': 'L\'application complète pour préparer votre examen du permis de conduire italien',
        'features': 'Fonctionnalités',
        'feature-1-title': '9 353 Questions Officielles',
        'feature-1-desc': 'Base de données complète des questions officielles de l\'examen de conduite italien avec traductions en 9 langues',
        'feature-2-title': 'Support Multilingue',
        'feature-2-desc': 'Disponible en italien, anglais, chinois, espagnol, français, allemand, arabe, russe et albanais',
        'feature-3-title': 'Modes Pratique et Test',
        'feature-3-desc': 'Pratiquez par catégorie ou difficulté, puis testez-vous avec des simulations d\'examen réalistes',
        'feature-4-title': 'Suivi des Progrès',
        'feature-4-desc': 'Suivez vos performances, revoyez les mauvaises réponses et concentrez-vous sur les sujets difficiles',
        'privacy-policy': 'Politique de Confidentialité',
        'terms-of-service': 'Conditions d\'Utilisation',
        'all-rights': 'Tous droits réservés.',
        'contact-support': 'Contacter le Support',
        'privacy': 'Confidentialité',
        'terms': 'Conditions',
        'last-updated': 'Dernière Mise à Jour',
        'introduction': 'Introduction',
        'accept': 'J\'accepte',
        'decline': 'Refuser'
    },
    de: {
        'app-title': 'IT Driving Test',
        'app-description': 'Die komplette App zur Vorbereitung auf Ihre italienische Führerscheinprüfung',
        'features': 'Funktionen',
        'feature-1-title': '9.353 Offizielle Fragen',
        'feature-1-desc': 'Vollständige Datenbank offizieller italienischer Fahrprüfungsfragen mit Übersetzungen in 9 Sprachen',
        'feature-2-title': 'Mehrsprachige Unterstützung',
        'feature-2-desc': 'Verfügbar auf Italienisch, Englisch, Chinesisch, Spanisch, Französisch, Deutsch, Arabisch, Russisch und Albanisch',
        'feature-3-title': 'Übungs- und Testmodi',
        'feature-3-desc': 'Üben Sie nach Kategorie oder Schwierigkeit, dann testen Sie sich mit realistischen Prüfungssimulationen',
        'feature-4-title': 'Fortschrittsverfolgung',
        'feature-4-desc': 'Verfolgen Sie Ihre Leistung, überprüfen Sie falsche Antworten und konzentrieren Sie sich auf schwierige Themen',
        'privacy-policy': 'Datenschutzrichtlinie',
        'terms-of-service': 'Nutzungsbedingungen',
        'all-rights': 'Alle Rechte vorbehalten.',
        'contact-support': 'Support kontaktieren',
        'privacy': 'Datenschutz',
        'terms': 'Bedingungen',
        'last-updated': 'Zuletzt Aktualisiert',
        'introduction': 'Einführung',
        'accept': 'Akzeptieren',
        'decline': 'Ablehnen'
    },
    ar: {
        'app-title': 'اختبار القيادة الإيطالي',
        'app-description': 'التطبيق الكامل للتحضير لامتحان رخصة القيادة الإيطالية',
        'features': 'الميزات',
        'feature-1-title': '9,353 سؤال رسمي',
        'feature-1-desc': 'قاعدة بيانات كاملة لأسئلة اختبار القيادة الإيطالي الرسمية مع ترجمات بـ 9 لغات',
        'feature-2-title': 'دعم متعدد اللغات',
        'feature-2-desc': 'متوفر بالإيطالية والإنجليزية والصينية والإسبانية والفرنسية والألمانية والعربية والروسية والألبانية',
        'feature-3-title': 'أوضاع الممارسة والاختبار',
        'feature-3-desc': 'تدرب حسب الفئة أو الصعوبة، ثم اختبر نفسك بمحاكاة اختبار واقعية',
        'feature-4-title': 'تتبع التقدم',
        'feature-4-desc': 'تتبع أدائك، راجع الإجابات الخاطئة، وركز على المواضيع الصعبة',
        'privacy-policy': 'سياسة الخصوصية',
        'terms-of-service': 'شروط الخدمة',
        'all-rights': 'جميع الحقوق محفوظة.',
        'contact-support': 'اتصل بالدعم',
        'privacy': 'الخصوصية',
        'terms': 'الشروط',
        'last-updated': 'آخر تحديث',
        'introduction': 'مقدمة',
        'accept': 'موافق',
        'decline': 'رفض'
    },
    ru: {
        'app-title': 'IT Driving Test',
        'app-description': 'Полное приложение для подготовки к итальянскому экзамену на водительские права',
        'features': 'Возможности',
        'feature-1-title': '9 353 официальных вопроса',
        'feature-1-desc': 'Полная база данных официальных вопросов итальянского экзамена по вождению с переводами на 9 языков',
        'feature-2-title': 'Многоязычная поддержка',
        'feature-2-desc': 'Доступно на итальянском, английском, китайском, испанском, французском, немецком, арабском, русском и албанском языках',
        'feature-3-title': 'Режимы практики и тестирования',
        'feature-3-desc': 'Практикуйтесь по категориям или сложности, затем проверьте себя с реалистичными симуляциями экзамена',
        'feature-4-title': 'Отслеживание прогресса',
        'feature-4-desc': 'Отслеживайте свою производительность, просматривайте неправильные ответы и сосредоточьтесь на сложных темах',
        'privacy-policy': 'Политика конфиденциальности',
        'terms-of-service': 'Условия обслуживания',
        'all-rights': 'Все права защищены.',
        'contact-support': 'Связаться с поддержкой',
        'privacy': 'Конфиденциальность',
        'terms': 'Условия',
        'last-updated': 'Последнее обновление',
        'introduction': 'Введение',
        'accept': 'Принять',
        'decline': 'Отклонить'
    },
    sq: {
        'app-title': 'IT Driving Test',
        'app-description': 'Aplikacioni i plotë për t\'u përgatitur për provimin e patentës italiane',
        'features': 'Veçoritë',
        'feature-1-title': '9,353 Pyetje Zyrtare',
        'feature-1-desc': 'Baza e plotë e të dhënave të pyetjeve zyrtare të testit italian të drejtimit me përkthime në 9 gjuhë',
        'feature-2-title': 'Mbështetje Shumëgjuhëshe',
        'feature-2-desc': 'E disponueshme në italisht, anglisht, kinezisht, spanjisht, frëngjisht, gjermanisht, arabisht, rusisht dhe shqip',
        'feature-3-title': 'Modalitetet e Praktikës dhe Testimit',
        'feature-3-desc': 'Praktikoni sipas kategorisë ose vështirësisë, pastaj testoni veten me simulime realiste të provimit',
        'feature-4-title': 'Ndjekja e Progresit',
        'feature-4-desc': 'Ndiqni performancën tuaj, rishikoni përgjigjet e gabuara dhe fokusohuni në temat sfiduese',
        'privacy-policy': 'Politika e Privatësisë',
        'terms-of-service': 'Kushtet e Shërbimit',
        'all-rights': 'Të gjitha të drejtat e rezervuara.',
        'contact-support': 'Kontaktoni Mbështetjen',
        'privacy': 'Privatësia',
        'terms': 'Kushtet',
        'last-updated': 'Përditësimi i Fundit',
        'introduction': 'Hyrje',
        'accept': 'Pranoj',
        'decline': 'Refuzoj'
    }
};

// Language management functions
function getCurrentLanguage() {
    const savedLang = localStorage.getItem('preferredLanguage');
    const urlParams = new URLSearchParams(window.location.search);
    const urlLang = urlParams.get('lang');
    const browserLang = navigator.language.split('-')[0];

    // Priority: URL param > saved preference > browser language > English
    if (urlLang && translations[urlLang]) {
        return urlLang;
    } else if (savedLang && translations[savedLang]) {
        return savedLang;
    } else if (translations[browserLang]) {
        return browserLang;
    }
    return 'en';
}

function changeLanguage(lang) {
    if (!translations[lang]) return;

    localStorage.setItem('preferredLanguage', lang);

    // Update text content
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translations[lang] && translations[lang][key]) {
            element.textContent = translations[lang][key];
        }
    });

    // Update page direction for Arabic
    document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
    document.documentElement.lang = lang;

    // Update links to include language parameter
    document.querySelectorAll('a').forEach(link => {
        const href = link.getAttribute('href');
        if (href && (href.includes('.html') || href === '/')) {
            const url = new URL(href, window.location.origin);
            url.searchParams.set('lang', lang);
            link.setAttribute('href', url.pathname + url.search);
        }
    });

    // Update select if it exists
    const select = document.getElementById('langSelect');
    if (select) {
        select.value = lang;
    }
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    const lang = getCurrentLanguage();
    changeLanguage(lang);
});